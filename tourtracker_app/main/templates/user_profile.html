{% extends "base.html" %}
{% block content %}
    <div class="navbar" id="navbar">
        <ul class="navbar__content noBullets">
            <li>
                <a href={{ url_for('main.index') }}><img src="/static/assets/images/tourtracker_logo.png"
                     height="50px"
                   alt="The tourtracker website logo"></a>
            </li>
        </ul>
    </div>
  <h1 id="draw">Tour Tracker</h1>

  {% with messages = get_flashed_messages() %}
  {% if messages %}
  {% for message in messages %}
      <h3 class="form__error">{{ message }}</h3>
  {% endfor %}
  {% endif %}
  {% endwith %}

  <p>User email: {{ email }}</p>

  {% if strava_authenticated %}
    <form method="POST" action="/createtour" class="form">
      {{ form.csrf_token }}
      {{ form.tour_name }}
      {{ form.site_url }}
      {{ form.start_date }}
      {{ form.auto_refresh }}
      {{ form.end_date }}
      {{ form.submit }}
    </form>
  {% endif %}

    {% if user_tours %}
      {% for tour in user_tours %}
        <a href="{{ url_for('main.tour_detail', uuid=tour.tour_uuid) }}">{{ tour.tour_name }}</a>
      {% endfor %}
    {% endif %}

    <form class="form">

      <button class="button pointer" type="submit" formaction={{ url_for('auth.logout') }}>Log Out</button>
    </form>


  {% else %}
    <form class="form">
      <button class="button pointer" type="submit" formaction={{ url_for('strava_api_auth.strava_auth') }}>Link Strava</button>
      <button class="button pointer" type="submit" formaction={{ url_for('auth.logout') }}>Log Out</button>
   </form>
  {% endif %}


      {% if not strava_authenticated %}
      <button type="submit" formaction={{ url_for('strava_api_auth.strava_auth') }}>Link Strava</button>
      {% endif %}
      {% if is_admin %}
        <button type="submit" formaction={{ url_for('strava_webhook.webhook_admin') }}>Webhook Admin</button>
      {% endif %}
      <button type="submit" formaction={{ url_for('auth.logout') }}>Log Out</button>
    </form>

   
  {% endblock %}


 







    
